# Sorting

Chapter III-7 — Analysis
III-132
// New weighting is square root of the expected Y values from the fit
sqrtNwave = sqrt(Gauss1D(W_coef, pnt2x(histwave, p)))
// Do a new fit
CurveFit/Q gauss histwave /W=sqrtNwave /I=1
Wave W_coef
// Compute the length of the difference between this fit and the last
MatrixOp/FREE/O delta = sqrt(sum(magSqr(W_coef - lastCoef)))
// Uncomment these lines if you would like to see the progress
// Print delta
// Print W_coef
// Rather arbitrary stopping criterion
if (delta[0] < 1e-8*initialLength)
break
endif
lastCoef = W_coef
while(1)
Wave W_sigma
Print "y0\t=\t",W_coef[0], "±", W_sigma[0]
Print "A\t=\t",W_coef[1], "±", W_sigma[1]
Print "x0\t=\t",W_coef[2], "±", W_sigma[2]
Print "width\t=\t",W_coef[3], "±", W_sigma[3]
End
To try it, paste the code into the procedure window, compile, and execute this on the command line:
FitGaussHistogram(gdata_Hist, W_SqrtN)
The result is:
y0
=
-0.985823 ± 1.22856
A
=
138.462 ± 5.31568
x0
=
-0.00928052 ± 0.0313763
width =
1.45437 ± 0.0521087
This result from this example is within one standard deviation of the weighted fit using the weighting wave 
generated by the histogram.
Computing an “Integrating” Histogram
In a histogram, each bin of the destination wave contains a count of the number of occurrences of values in 
the source that fell within the bounds of the bin. In an integrating histogram, instead of counting the occur-
rences of a value within the bin, we add the value itself to the bin. When we’re done, the destination wave 
contains the sum of all values in the source which fell within the bounds of the bin.
Igor comes with an example experiment called “Integrating Histogram” that illustrates how to do this with 
a user function. To see the example, choose FileExample ExperimentsAnalysisIntegrating Histo-
gram.
Sorting
The Sort operation (see page V-883) sorts one or more 1D numeric or text waves in ascending or descending 
order.
The Sort operation is often used to prepare a wave or an XY pair for subsequent analysis. For example, the 
interp function assumes that the X input wave is monotonic.
