# Interpolation

Chapter III-7 — Analysis
III-114
Replace Missing Data Using the Interpolate2 Operation
By using the same number of points for the destination as you have source points, you can replace NaNs 
without modifying the other data.
If you have waveform data, simply duplicate your data and perform linear interpolation using the same 
number of points as your data. For example, assuming 100 data points:
Duplicate data1,data1a
Interpolate/T=1/N=100/Y=data1a data1
If you have XY data, the Interpolate2 operation has the ability to include the input x values in the output X 
wave. For example:
Duplicate data1, yData1, xData1
xData1 = x
Display yData1 vs xData1
Interpolate2/T=1/N=100/I/Y=yData1a/X=xData1a xData1,yData1
If, after performing an operation on your data, you wish to put the modified data back in the source wave 
while maintaining the original missing values you can use a wave assignment similar to this:
yData1 = (numtype(yData1) == 0) ? yData1 : yData1a
This technique can also be applied using interpolated results generated by the Smooth operation (page 
V-878) or the Loess operation (page V-515).
Replace Missing Data Using Median Smoothing
You can use the Smooth dialog to replace each NaN with the median of surrounding values.
Select the Median smoothing algorithm, select "NaNs" from the Replace popup, and choose "Median" for 
the "with:" radio button. Enter the number of surrounding points used to compute the median (an odd 
number is best).
You can choose to overwrite the NaNs or create a new waveform with the result. The Smooth dialog pro-
duces commands like this:
Duplicate/O data1,data1_smth;DelayUpdate
Smooth/M=(NaN) 5, data1_smth
Interpolation
Igor Pro has a number of interpolation tools that are designed for different applications. We summarize 
these in the table below.
Data
Operation/Function
Interpolation Method
1D waves
wave assignment, e.g., val=wave(x)
Linear
1D waves
Smooth
Running median, average, binomial, 
Savitsky-Golay
1D XY waves
interp()
Linear
1D single or XY waves
The Interpolate2 Operation
Linear, cubic spline, smoothing spline
1D or 2D single or XY
Loess
Locally-weighted regression
Triplet XYZ waves
ImageInterpolate
Voronoi
1D X, Y, Z waves
DataPackagesXYZ to Matrix
Voronoi
1D X, Y, Z waves
Loess
Locally-weighted regression
2D waves
ImageInterpolate
Bilinear, splines, Kriging, Voronoi
